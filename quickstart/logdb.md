### 创建&设置日志仓库

**操作流程：**

进入日志检索服务，点击**创建仓库**按钮，开始创建第一个数据仓库。

创建完成仓库后，在资源列表，设置时间排序字段。

**时间排序字段**是指查询出的日志内容按照这个时间内容倒序排列。

**数据源/消息队列节点填写参数说明：**

|参数|必填|说明|
|:---|:---|:---|
|仓库名称|是|用来区分其他仓库，唯一标识，用户自行命名|
|所属区域|是|所属区域,计算与存储所使用的物理资源所在区域,目前支持华东区域；</br>此参数是为了降低用户传输数据的成本；应当尽量选择离自己数据源较近的区域|
|数据存储时限|是|数据存储的时限，最小为1天，最大为30天，存储时间超过这个时限的数据，将会被系统自动删除，为0时，数据永久存储|
|字段|是|字段名称与类型|

**操作演示：**

![](_media/logdb-createRepo.gif)

### 日志查询

**操作流程：**

点击页面左侧的**日志查询**，进入查询页面。

首先我们选择一个数据仓库，然后在条件编辑框里编写搜索条件，最后点击数据查询按钮/图表查询按钮即可。

> 提示：
> 
> 1.点击**查询字段**按钮，可以查看这个仓库的字段信息。
> 
> 2.搜索栏上方的时间选择按钮，可以选择查询时间范围。
> 
> 3.在查询时，点击搜索栏右侧的停止按钮可中止本次查询。

**操作演示：**

![](_media/search_logdb.gif)

### 条件编写规范

|名称|语义|
|:--|:--|
|*|查询所有内容|
|AND|query1 AND query2，查询交集|
|OR	|query1 OR query2，查询并集|
|NOT|query1 NOT query2，表示符合query1，不符合query2的结果|
|()	|把一个或多个query合并成一个query，提升优先级|
|[]	|区间查询，包括边界|
|{}|区间查询，不包括边界|
|\|转义字符|
|>,=,<,<=,>=|区间查询|

**查询举例：**

字段名称`name`，类型`string`，包含内容`a`的记录：

?>name:a

字段名称`ip`，类型`string`，包含内容`a`或`b`的记录：

?>ip:a OR ip:b

字段名称`hosts`，类型`string`，包含内容`a`或者`b`,不包含`c`的记录：

?>(hosts:a OR hosts:b) AND (NOT hosts:c)

字段名称`ip`，类型`string`，包含内容`a`或`b`，同时字段名称`hosts`，类型`string`，包含内容`c`的记录：

?>(ip:a OR ip:b) AND (hosts:c)

字段名称`createTime`，类型`date`，包含内容`2016-1-1`到`2016-1-2`的记录：

?>createTime:[2016-01-01 TO 2016-01-02]

字段名称`count`，类型`long`或者`float`，内容大于5的记录： 

?>count:>5


!>日志检索服务在输入查询条件时，在搜索内容中，如果日志记录中包含以下符号，在搜索时，需要以`双引号("")`包含。

```
+  -  
&&  ||  !
( )  { }  [ ] 
^  ”  ~  *  ?  :  \
```

### 使用Kibana

在申请开通Kibana服务后，我们只需要在Setting界面添加`仓库`，即可进行搜索。

1. 打开kibana页面后，输入在LogDB已经创建的`仓库`名字（注：仓库中没有数据时，将不会添加成功)。

	![kibana](http://oji8s4dhx.bkt.clouddn.com/kibana-guide-1.jpeg)

2. 添加成功后，即可进入`Discover`模块进行数据搜索。

	
	![kibana1](http://oji8s4dhx.bkt.clouddn.com/discover.jpeg)


* 暂时不支持Kibana的图表功能，只有搜索功能可用。


### 使用Grafana